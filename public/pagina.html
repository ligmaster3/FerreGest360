<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FerreGest360 - Sistema de Gestión para Ferreterías</title>
    <link rel="stylesheet" href="/public/css/styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>

<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <div class="login-box">
            <div class="login-header">
                <i class="fas fa-tools"></i>
                <h1>FerreGest360</h1>
                <p>Sistema de Gestión para Ferreterías</p>
            </div>

            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="email">Correo Electrónico</label>
                    <div class="input-container">
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="email" name="email" required placeholder="tu@email.com">
                    </div>
                </div>

                <div class="form-group">
                    <label for="password">Contraseña</label>
                    <div class="input-container">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="password" name="password" required placeholder="Tu contraseña">
                        <button type="button" class="toggle-password" onclick="togglePassword()">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>

                <button type="submit" class="login-btn">
                    <i class="fas fa-sign-in-alt"></i>
                    Iniciar Sesión
                </button>

            </form>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div id="dashboardScreen" class="dashboard-container hidden">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <i class="fas fa-tools"></i>
                <span class="sidebar-title">FerreGest360</span>
            </div>

            <div class="user-info">
                <div class="user-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="user-details">
                    <span class="user-name">Admin Sistema</span>
                    <span class="user-role">Administrador</span>
                </div>
            </div>

            <ul class="nav-menu">
                <li class="nav-item active" data-section="dashboard">
                    <a href="#" class="nav-link">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item" data-section="productos">
                    <a href="#" class="nav-link">
                        <i class="fas fa-boxes"></i>
                        <span>Productos</span>
                    </a>
                </li>
                <li class="nav-item" data-section="inventario">
                    <a href="#" class="nav-link">
                        <i class="fas fa-warehouse"></i>
                        <span>Inventario</span>
                    </a>
                </li>
                <li class="nav-item" data-section="ventas">
                    <a href="#" class="nav-link">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Ventas</span>
                    </a>
                </li>
                <li class="nav-item" data-section="clientes">
                    <a href="#" class="nav-link">
                        <i class="fas fa-users"></i>
                        <span>Clientes</span>
                    </a>
                </li>
                <li class="nav-item" data-section="proveedores">
                    <a href="#" class="nav-link">
                        <i class="fas fa-truck"></i>
                        <span>Proveedores</span>
                    </a>
                </li>
                <li class="nav-item" data-section="compras">
                    <a href="#" class="nav-link">
                        <i class="fas fa-shopping-bag"></i>
                        <span>Compras</span>
                    </a>
                </li>
                <li class="nav-item" data-section="reportes">
                    <a href="#" class="nav-link">
                        <i class="fas fa-chart-bar"></i>
                        <span>Reportes</span>
                    </a>
                </li>
            </ul>

            <div class="sidebar-footer">
                <button class="logout-btn" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Cerrar Sesión</span>
                </button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <button class="menu-toggle" onclick="toggleSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="search-container">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Buscar productos, clientes..." class="search-input">
                    </div>
                </div>

                <div class="header-right">
                    <button class="notification-btn">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">3</span>
                    </button>
                    <div class="current-date">
                        <span id="currentDate"></span>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Dashboard Section -->
                <section id="dashboard-content" class="content-section active">
                    <div class="page-header">
                        <h1>Dashboard</h1>
                        <p>Resumen general de tu ferretería</p>
                    </div>

                    <!-- Stats Cards -->
                    <div class="stats-grid">
                        <div class="stat-card revenue">
                            <div class="stat-icon">
                                <i class="fas fa-dollar-sign"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Ventas Hoy</h3>
                                <p class="stat-value">$1,250.50</p>
                                <span class="stat-change positive">+12%</span>
                            </div>
                        </div>

                        <div class="stat-card products">
                            <div class="stat-icon">
                                <i class="fas fa-boxes"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Total Productos</h3>
                                <p class="stat-value">245</p>
                                <span class="stat-change neutral">Activos</span>
                            </div>
                        </div>

                        <div class="stat-card stock">
                            <div class="stat-icon">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Stock Bajo</h3>
                                <p class="stat-value">12</p>
                                <span class="stat-change negative">Crítico</span>
                            </div>
                        </div>

                        <div class="stat-card clients">
                            <div class="stat-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Clientes</h3>
                                <p class="stat-value">89</p>
                                <span class="stat-change positive">+5 nuevos</span>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="quick-actions">
                        <h2>Acciones Rápidas</h2>
                        <div class="actions-grid">
                            <button class="action-btn primary" onclick="showSection('ventas')">
                                <i class="fas fa-shopping-cart"></i>
                                <span>Nueva Venta</span>
                            </button>
                            <button class="action-btn secondary" onclick="showSection('productos')">
                                <i class="fas fa-plus"></i>
                                <span>Agregar Producto</span>
                            </button>
                            <button class="action-btn secondary" onclick="showSection('clientes')">
                                <i class="fas fa-user-plus"></i>
                                <span>Nuevo Cliente</span>
                            </button>
                            <button class="action-btn secondary" onclick="showSection('reportes')">
                                <i class="fas fa-chart-line"></i>
                                <span>Ver Reportes</span>
                            </button>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="activity-section">
                        <div class="low-stock-alert">
                            <h3><i class="fas fa-exclamation-triangle"></i> Productos con Stock Bajo</h3>
                            <div class="alert-list">
                                <div class="alert-item">
                                    <span class="product-name">Martillo de garra 16oz</span>
                                    <span class="stock-info">Stock: 2 | Mínimo: 5</span>
                                    <span class="alert-badge critical">Crítico</span>
                                </div>
                                <div class="alert-item">
                                    <span class="product-name">Pintura blanca 1 galón</span>
                                    <span class="stock-info">Stock: 1 | Mínimo: 3</span>
                                    <span class="alert-badge critical">Crítico</span>
                                </div>
                                <div class="alert-item">
                                    <span class="product-name">Taladro eléctrico 1/2"</span>
                                    <span class="stock-info">Stock: 1 | Mínimo: 2</span>
                                    <span class="alert-badge critical">Crítico</span>
                                </div>
                            </div>
                        </div>

                        <div class="recent-sales">
                            <h3><i class="fas fa-shopping-cart"></i> Ventas Recientes</h3>
                            <div class="sales-list">
                                <div class="sale-item">
                                    <div class="sale-info">
                                        <span class="invoice-number">F000001</span>
                                        <span class="customer-name">Juan Pérez</span>
                                    </div>
                                    <div class="sale-amount">$125.50</div>
                                    <div class="sale-time">hace 2 horas</div>
                                </div>
                                <div class="sale-item">
                                    <div class="sale-info">
                                        <span class="invoice-number">F000002</span>
                                        <span class="customer-name">María González</span>
                                    </div>
                                    <div class="sale-amount">$89.25</div>
                                    <div class="sale-time">hace 3 horas</div>
                                </div>
                                <div class="sale-item">
                                    <div class="sale-info">
                                        <span class="invoice-number">F000003</span>
                                        <span class="customer-name">Carlos Rodríguez</span>
                                    </div>
                                    <div class="sale-amount">$267.80</div>
                                    <div class="sale-time">hace 5 horas</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Productos Section -->
                <section id="productos-content" class="content-section">
                    <div class="page-header">
                        <h1>Gestión de Productos</h1>
                        <button class="btn-primary" onclick="showAddProductModal()">
                            <i class="fas fa-plus"></i>
                            Agregar Producto
                        </button>
                    </div>

                    <div class="filters-bar">
                        <div class="filter-group">
                            <input type="text" placeholder="Buscar productos..." class="filter-input">
                            <select class="filter-select">
                                <option value="">Todas las categorías</option>
                                <option value="1">Herramientas</option>
                                <option value="2">Ferretería</option>
                                <option value="3">Plomería</option>
                                <option value="4">Electricidad</option>
                                <option value="5">Construcción</option>
                                <option value="6">Pintura</option>
                                <option value="7">Jardín</option>
                            </select>
                            <select class="filter-select">
                                <option value="">Todas las marcas</option>
                                <option value="1">Stanley</option>
                                <option value="2">Black & Decker</option>
                                <option value="3">Truper</option>
                                <option value="4">DeWalt</option>
                            </select>
                        </div>
                    </div>

                    <div class="data-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Código</th>
                                    <th>Producto</th>
                                    <th>Categoría</th>
                                    <th>Marca</th>
                                    <th>Stock</th>
                                    <th>Precio Venta</th>
                                    <th>Estado</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>MART001</td>
                                    <td>
                                        <div class="product-info">
                                            <span class="product-name">Martillo de garra 16oz</span>
                                            <span class="product-desc">Martillo de garra Stanley 16 onzas</span>
                                        </div>
                                    </td>
                                    <td>Herramientas</td>
                                    <td>Stanley</td>
                                    <td><span class="stock-badge low">2</span></td>
                                    <td>$25.00</td>
                                    <td><span class="status-badge active">Activo</span></td>
                                    <td>
                                        <div class="action-buttons">
                                            <button class="btn-edit" title="Editar">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn-delete" title="Eliminar">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>DEST001</td>
                                    <td>
                                        <div class="product-info">
                                            <span class="product-name">Destornillador plano 6"</span>
                                            <span class="product-desc">Destornillador plano Stanley 6 pulgadas</span>
                                        </div>
                                    </td>
                                    <td>Herramientas</td>
                                    <td>Stanley</td>
                                    <td><span class="stock-badge normal">25</span></td>
                                    <td>$6.00</td>
                                    <td><span class="status-badge active">Activo</span></td>
                                    <td>
                                        <div class="action-buttons">
                                            <button class="btn-edit" title="Editar">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn-delete" title="Eliminar">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>PINB001</td>
                                    <td>
                                        <div class="product-info">
                                            <span class="product-name">Pintura blanca 1 galón</span>
                                            <span class="product-desc">Pintura látex blanca interior/exterior</span>
                                        </div>
                                    </td>
                                    <td>Pintura</td>
                                    <td>Sherwin Williams</td>
                                    <td><span class="stock-badge critical">1</span></td>
                                    <td>$45.00</td>
                                    <td><span class="status-badge active">Activo</span></td>
                                    <td>
                                        <div class="action-buttons">
                                            <button class="btn-edit" title="Editar">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn-delete" title="Eliminar">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Other sections placeholders -->
                <section id="inventario-content" class="content-section">
                    <div class="page-header">
                        <h1>Control de Inventario</h1>
                        <p>Gestión de stock y movimientos</p>
                    </div>
                    <div class="coming-soon">
                        <i class="fas fa-warehouse"></i>
                        <h2>Módulo en Desarrollo</h2>
                        <p>El módulo de inventario estará disponible próximamente</p>
                    </div>
                </section>

                <section id="ventas-content" class="content-section">
                    <div class="page-header">
                        <h1>Punto de Venta</h1>
                        <p>Facturación y gestión de ventas</p>
                    </div>
                    <div class="coming-soon">
                        <i class="fas fa-shopping-cart"></i>
                        <h2>Módulo en Desarrollo</h2>
                        <p>El módulo de ventas estará disponible próximamente</p>
                    </div>
                </section>

                <section id="clientes-content" class="content-section">
                    <div class="page-header">
                        <h1>Gestión de Clientes</h1>
                        <button class="btn-primary" onclick="showAddClientModal()">
                            <i class="fas fa-user-plus"></i>
                            Nuevo Cliente
                        </button>
                    </div>

                    <div class="data-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Cédula</th>
                                    <th>Teléfono</th>
                                    <th>Correo</th>
                                    <th>Dirección</th>
                                </tr>
                            </thead>
                            <tbody id="clientesTabla">
                                <!-- Aquí se cargan dinámicamente los clientes -->
                            </tbody>
                        </table>
                    </div>
                </section>


                <section id="proveedores-content" class="content-section">
                    <div class="page-header">
                        <h1>Gestión de Proveedores</h1>
                        <p>Administración de proveedores y compras</p>
                    </div>
                    <div class="coming-soon">
                        <i class="fas fa-truck"></i>
                        <h2>Módulo en Desarrollo</h2>
                        <p>El módulo de proveedores estará disponible próximamente</p>
                    </div>
                </section>

                <section id="compras-content" class="content-section">
                    <div class="page-header">
                        <h1>Órdenes de Compra</h1>
                        <p>Gestión de compras y órdenes</p>
                    </div>
                    <div class="coming-soon">
                        <i class="fas fa-shopping-bag"></i>
                        <h2>Módulo en Desarrollo</h2>
                        <p>El módulo de compras estará disponible próximamente</p>
                    </div>
                </section>

                <section id="reportes-content" class="content-section">
                    <div class="page-header">
                        <h1>Reportes y Estadísticas</h1>
                        <p>Análisis y reportes del negocio</p>
                    </div>
                    <div class="coming-soon">
                        <i class="fas fa-chart-bar"></i>
                        <h2>Módulo en Desarrollo</h2>
                        <p>El módulo de reportes estará disponible próximamente</p>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Modal for Add Product -->
    <div id="addProductModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-plus"></i> Agregar Nuevo Producto</h2>
                <button class="modal-close" onclick="closeModal('addProductModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <form id="formCliente" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="productCode">Código del Producto</label>
                        <input type="text" id="productCode" name="productCode" required>
                    </div>
                    <div class="form-group">
                        <label for="productBarcode">Código de Barras</label>
                        <input type="text" id="productBarcode" name="productBarcode">
                    </div>
                </div>

                <div class="form-group">
                    <label for="productName">Nombre del Producto</label>
                    <input type="text" id="productName" name="productName" required>
                </div>

                <div class="form-group">
                    <label for="productDescription">Descripción</label>
                    <textarea id="productDescription" name="productDescription" rows="3"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="productCategory">Categoría</label>
                        <select id="productCategory" name="productCategory">
                            <option value="">Seleccionar categoría</option>
                            <option value="1">Herramientas</option>
                            <option value="2">Ferretería</option>
                            <option value="3">Plomería</option>
                            <option value="4">Electricidad</option>
                            <option value="5">Construcción</option>
                            <option value="6">Pintura</option>
                            <option value="7">Jardín</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="productBrand">Marca</label>
                        <select id="productBrand" name="productBrand">
                            <option value="">Seleccionar marca</option>
                            <option value="1">Stanley</option>
                            <option value="2">Black & Decker</option>
                            <option value="3">Truper</option>
                            <option value="4">DeWalt</option>
                            <option value="5">Makita</option>
                            <option value="6">Sherwin Williams</option>
                            <option value="7">Genérica</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="purchasePrice">Precio de Compra</label>
                        <input type="number" id="purchasePrice" name="purchasePrice" step="0.01" min="0">
                    </div>
                    <div class="form-group">
                        <label for="salePrice">Precio de Venta</label>
                        <input type="number" id="salePrice" name="salePrice" step="0.01" min="0" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="minStock">Stock Mínimo</label>
                        <input type="number" id="minStock" name="minStock" min="0" value="0">
                    </div>
                    <div class="form-group">
                        <label for="initialStock">Stock Inicial</label>
                        <input type="number" id="initialStock" name="initialStock" min="0" value="0">
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('addProductModal')">
                        Cancelar
                    </button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i>
                        Guardar Producto
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        function showAddClientModal() {
            document.getElementById('addClientModal').classList.remove('hidden');
        }

        function cargarClientes() {
            // Envío del formulario de clientes con AJAX
            document.getElementById('formCliente').addEventListener('submit', function (e) {
                e.preventDefault();

                const form = e.target;
                const datos = new FormData(form);

                fetch('guardar_cliente.php', {
                    method: 'POST',
                    body: datos
                })
                    .then(res => res.text())
                    .then(respuesta => {
                        alert(respuesta); // Muestra mensaje de guardado
                        closeModal('addClientModal');
                        form.reset();
                        cargarClientes(); // Recargar la tabla de clientes
                    })
                    .catch(err => {
                        alert("Error al guardar el cliente.");
                        console.error(err);
                    });
            });

            fetch('listar_clientes.php')
                .then(res => res.text())
                .then(html => {
                    document.getElementById('clientesTabla').innerHTML = html;
                });
        }

        document.addEventListener('DOMContentLoaded', () => {
            cargarClientes();
        });




        // Variables globales
        let sidebarCollapsed = false;

        // Inicialización
        document.addEventListener('DOMContentLoaded', function () {
            updateCurrentDate();
            setInterval(updateCurrentDate, 60000); // Actualizar cada minuto

            // Event listeners
            setupNavigation();
            setupLoginForm();
        });

        // Funciones de autenticación
        function setupLoginForm() {
            const loginForm = document.getElementById('loginForm');
            loginForm.addEventListener('submit', function (e) {
                e.preventDefault();

                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;

                // Simulación de login (en producción esto sería una llamada a la API)
                if (email === 'admin@ferreteria.com' && password === 'hello') {
                    document.getElementById('loginScreen').classList.add('hidden');
                    document.getElementById('dashboardScreen').classList.remove('hidden');
                } else {
                    alert('Credenciales incorrectas');
                }
            });
        }

        function logout() {
            document.getElementById('dashboardScreen').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('loginForm').reset();
        }

        function togglePassword() {
            const passwordInput = document.getElementById('password');
            const toggleBtn = document.querySelector('.toggle-password i');

            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleBtn.className = 'fas fa-eye-slash';
            } else {
                passwordInput.type = 'password';
                toggleBtn.className = 'fas fa-eye';
            }
        }

        // Funciones de navegación
        function setupNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', function (e) {
                    e.preventDefault();
                    const section = this.dataset.section;
                    showSection(section);
                });
            });
        }

        function showSection(sectionName) {
            // Ocultar todas las secciones
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => section.classList.remove('active'));

            // Mostrar la sección seleccionada
            const targetSection = document.getElementById(sectionName + '-content');
            if (targetSection) {
                targetSection.classList.add('active');
            }

            // Actualizar navegación activa
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));

            const activeNavItem = document.querySelector(`[data-section="${sectionName}"]`);
            if (activeNavItem) {
                activeNavItem.classList.add('active');
            }
        }

        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const mainContent = document.querySelector('.main-content');

            sidebarCollapsed = !sidebarCollapsed;

            if (sidebarCollapsed) {
                sidebar.classList.add('collapsed');
                mainContent.classList.add('expanded');
            } else {
                sidebar.classList.remove('collapsed');
                mainContent.classList.remove('expanded');
            }
        }

        // Funciones de modal
        function showAddProductModal() {
            document.getElementById('addProductModal').classList.remove('hidden');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        // Función para actualizar fecha
        function updateCurrentDate() {
            const now = new Date();
            const options = {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                weekday: 'long'
            };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('es-ES', options);
        }

        // Cerrar modal al hacer clic fuera
        window.addEventListener('click', function (e) {
            if (e.target.classList.contains('modal')) {
                e.target.classList.add('hidden');
            }
        });
    </script>
    <div id="addClientModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-user-plus"></i> Registrar Cliente</h2>
                <button class="modal-close" onclick="closeModal('addClientModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="modal-form" method="POST" action="guardar_cliente.php">
                <div class="form-group">
                    <label for="nombre">Nombre Completo</label>
                    <input type="text" id="nombre" name="nombre" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="cedula">Cédula</label>
                        <input type="text" id="cedula" name="cedula">
                    </div>
                    <div class="form-group">
                        <label for="telefono">Teléfono</label>
                        <input type="text" id="telefono" name="telefono">
                    </div>
                </div>
                <div class="form-group">
                    <label for="correo">Correo</label>
                    <input type="email" id="correo" name="correo">
                </div>
                <div class="form-group">
                    <label for="direccion">Dirección</label>
                    <textarea id="direccion" name="direccion" rows="2"></textarea>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('addClientModal')">
                        Cancelar
                    </button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Guardar Cliente
                    </button>
                </div>
            </form>
        </div>
    </div>



    function verFactura(id) {
    fetch(`ventas.php?action=get_factura_details&id=${id}`)
    .then(response => response.json())
    .then(data => {
    if (data.error) {
    alert(data.error);
    return;
    }
    const body = document.getElementById('viewFacturaBody');

    // Formateadores
    const formatDate = (fecha) => fecha ? new Date(fecha).toLocaleDateString('es-PA') : '';
    const formatCurrency = (valor) => `$${parseFloat(valor || 0).toFixed(2)}`;

    // Encabezado y datos
    const emisor = {
    nombre: 'FerreGest360',
    direccion: 'Dirección de la empresa',
    nif: 'NIF/ID Empresa',
    ciudad: 'Ciudad, País',
    email: 'info@ferregest360.com'
    };
    const cliente = {
    nombre: data.cliente_nombre || 'Cliente',
    direccion: data.direccion || '',
    cedula: data.cedula_ruc || '',
    ciudad: '',
    email: data.email || ''
    };

    // Tabla de productos
    let itemsHtml = data.items.map(item => `
    <tr>
        <td class="py-2 text-center">${item.cantidad}</td>
        <td class="py-2">${item.producto_nombre}</td>
        <td class="py-2 text-right">${formatCurrency(item.precio_unitario)}</td>
        <td class="py-2 text-right">${formatCurrency(item.subtotal)}</td>
    </tr>`).join('');

    // Totales
    const subtotal = formatCurrency(data.subtotal_calc);
    const descuento = formatCurrency(data.descuento_calc);
    const itbms = formatCurrency(data.itbms_calc);
    const total = formatCurrency(data.total_calc);

    body.innerHTML = `
    <div class="bg-white p-6 rounded shadow max-w-4xl mx-auto">
        <!-- Encabezado -->
        <div class="border-b pb-4 mb-4">
            <div class="flex justify-between items-center">
                <h2 class="text-2xl font-bold">${emisor.nombre}</h2>
                <div class="text-right">
                    <p class="text-sm">${emisor.direccion}</p>
                    <p class="text-sm">${emisor.ciudad}</p>
                    <h1 class="text-xl font-bold text-blue-700">Factura</h1>
                    <p><span class="font-semibold">Fecha de factura:</span> ${formatDate(data.fecha_factura)}</p>
                    <p><span class="font-semibold">Número de factura:</span> ${data.numero_factura}</p>
                    <p><span class="font-semibold">Fecha de vencimiento:</span> ${formatDate(data.fecha_vencimiento)}
                    </p>
                </div>
            </div>
        </div>

        <!-- Facturar/Enviar a -->
        <div class="grid grid-cols-3 gap-4 text-sm mb-6">
            <div>
                <h2 class="font-bold text-blue-800 mb-1">${emisor.nombre}</h2>
                <p><span class="font-semibold">Dirección:</span> ${emisor.direccion}</p>
                <p><span class="font-semibold">NIF:</span> ${emisor.nif}</p>
                <p><span class="font-semibold">CP y ciudad:</span> ${emisor.ciudad}</p>
                <p><span class="font-semibold">Email:</span> ${emisor.email}</p>
            </div>
            
            <div>
                <h2 class="font-bold text-blue-800 mb-1">${cliente.nombre}</h2>
                <p><span class="font-semibold">Dirección:</span> ${cliente.direccion}</p>
                <p><span class="font-semibold">Cédula/RUC:</span> ${cliente.cedula}</p>
                <p><span class="font-semibold">Ciudad:</span> ${cliente.ciudad}</p>
                <p><span class="font-semibold">Email:</span> ${cliente.email}</p>
            </div>
        </div>

        <!-- Detalle productos -->
        <div class="border-t border-b py-4 mb-4">
            <table class="w-full text-sm text-left mt-4">
                <thead class="border-b">
                    <tr>
                        <th class="py-2">Cant.</th>
                        <th class="py-2">Descripción</th>
                        <th class="py-2 text-right">Precio Unitario</th>
                        <th class="py-2 text-right">Importe</th>
                    </tr>
                </thead>
                <tbody>
                    ${itemsHtml}
                </tbody>
            </table>
            <div class="text-right mt-4 text-sm">
                <p><strong>Subtotal:</strong> ${subtotal}</p>
                <p><strong>Descuento:</strong> ${descuento}</p>
                <p><strong>ITBMS:</strong> ${itbms}</p>
            </div>
            <div class="flex justify-between items-center mb-2">
                <h3 class="text-xl font-bold">Total Factura</h3>
                <p class="text-2xl font-bold">${total}</p>
            </div>
        </div>

        <!-- Condiciones -->
        <div class="text-sm mt-4">
            <h4 class="font-semibold uppercase mb-1">Condiciones y forma de pago</h4>
            <p>El pago se realizará en un plazo de 15 días</p>
            <p class="mt-2">Banco Santander</p>
            <p>IBAN: ES12 3456 7891</p>
            <p>SWIFT/BIC: ABCDESM1XXX</p>
        </div>

        <!-- Firma -->
        <div class="text-right mt-8">
            <p class="italic">${data.vendedor_nombre || 'Vendedor'}</p>
        </div>
    </div>

    `;
    document.getElementById('view-numero-factura').innerText = data.numero_factura;
    document.getElementById('viewFacturaModal').classList.remove('hidden');
    });
    }













</body>

</html>